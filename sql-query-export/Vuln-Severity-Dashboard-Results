-- Matches exploitable vulnerability by severity dashboard card pie count
-- Copy the SQL query below

SELECT
(SELECT COUNT(dv.severity) WHERE dv.severity='Critical') AS "Critical Vulns", (SELECT COUNT(dv.severity) WHERE dv.severity='Severe') AS "Severe Vulns", (SELECT COUNT(dv.severity) WHERE dv.severity='Moderate') AS "Moderate Vulns"
FROM fact_asset_vulnerability_finding favf JOIN dim_vulnerability dv ON dv.vulnerability_id=favf.vulnerability_id
JOIN dim_asset USING(asset_id)
JOIN dim_site_asset USING(asset_id)
JOIN dim_site as ds USING(site_id)
GROUP BY dv.severity
